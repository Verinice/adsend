!function(){function e(e){let t,n,i=e.length;for(;i;)n=Math.floor(Math.random()*i--),t=e[i],e[i]=e[n],e[n]=t;return e}const t=new WeakMap;function n(n,i){let l=t.get(n);return l&&0!==l.length||(l=e([...i]),t.set(n,l)),l.shift()}function i(e,t,i){if(t.classList.contains("ad-send-banner")||t.id?.startsWith("banner-slot-")){let i=t.querySelector(".ad-send-banner");i||(i=document.createElement("div"),i.className="ad-send-banner",i.style.width="100%",i.style.height="100%",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.overflow="hidden",i.style.minHeight="unset",i.style.maxHeight="unset",i.style.boxSizing="border-box",t.innerHTML="",t.appendChild(i));const l=t.getBoundingClientRect();i.style.height=l.height+"px",i.style.maxHeight=l.height+"px",i.style.minHeight=l.height+"px",i.style.width="100%";const r=n(t,e);i.innerHTML=r;const s=i.firstElementChild;s&&(s.style.width="100%",s.style.height="100%",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="center",s.style.overflow="hidden",s.style.boxSizing="border-box");i.querySelectorAll("img").forEach((e=>{e.style.maxWidth="100%",e.style.maxHeight="100%",e.style.width="100%",e.style.height="100%",e.style.objectFit="contain",e.style.display="block",e.style.margin="0",e.style.boxSizing="border-box"}));return void i.querySelectorAll("iframe").forEach((e=>{e.style.width="100%",e.style.height="100%",e.style.display="block"}))}let r=t.querySelector(".ad-send-banner");const s=Array.from(t.children).filter((e=>!e.classList.contains("ad-send-banner")));if(s.length<3)return;let o;if(void 0!==t.dataset.adIndex)o=parseInt(t.dataset.adIndex,10),(isNaN(o)||o<1||o>=s.length-1)&&(o=1,t.dataset.adIndex=o);else{const e=[];for(let t=1;t<s.length-1;t++)e.push(t);if(o=e[Math.floor(Math.random()*e.length)],void 0===o)return;t.dataset.adIndex=o}const d=s[o],h=d.getBoundingClientRect(),c=h.width,y=h.height;r?(r.previousSibling!==d&&(d.nextSibling?t.insertBefore(r,d.nextSibling):t.appendChild(r)),r.style.width=c+"px",r.style.height=y+"px",r.style.minWidth=c+"px",r.style.minHeight=y+"px",r.style.maxWidth=c+"px",r.style.maxHeight=y+"px"):(r=document.createElement("div"),r.className="ad-send-banner",r.style.width=c+"px",r.style.height=y+"px",r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.style.overflow="hidden",r.style.minWidth=c+"px",r.style.minHeight=y+"px",r.style.maxWidth=c+"px",r.style.maxHeight=y+"px",d.nextSibling?t.insertBefore(r,d.nextSibling):t.appendChild(r));let g=Array.from(t.children).filter((e=>e!==r&&!e.classList.contains("ad-send-banner"))),f=n(t,e),m=null;if(a){let e=t.querySelector(a);if(e){const t=e.cloneNode(!0);if(l&&l.length&&window._adConfigBanners&&(m=window._adConfigBanners.find((e=>f.includes(e.imageUrl)))),m){const e=t.querySelector("a");e&&m.targetUrl&&(e.setAttribute("href",m.targetUrl),e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"));const n=t.querySelector("img");n&&m.imageUrl&&n.setAttribute("src",m.imageUrl)}r.innerHTML="",r.appendChild(t),g=[e]}}else!function(e,t){if(!t.length)return;const n=Array.from(t).find((t=>t!==e&&"none"!==window.getComputedStyle(t).display));if(!n)return;const i=window.getComputedStyle(n);for(let t=0;t<i.length;t++){const n=i[t];e.style.setProperty(n,i.getPropertyValue(n),i.getPropertyPriority(n))}e.className=n.className.split(" ").filter((e=>e&&"ad-send-banner"!==e)).concat(["ad-send-banner"]).join(" "),n.id&&n.id!==e.id&&(e.id=n.id+"-ad")}(r,g),r.innerHTML=f;const u=r.firstElementChild;u&&(u.style.width="100%",u.style.height="100%",u.style.display="flex",u.style.alignItems="center",u.style.justifyContent="center",u.style.overflow="hidden",u.style.boxSizing="border-box");r.querySelectorAll("img").forEach((e=>{e.style.maxWidth="100%",e.style.maxHeight="100%",e.style.width="100%",e.style.height="100%",e.style.objectFit="contain",e.style.display="block",e.style.margin="0",e.style.boxSizing="border-box"}));r.querySelectorAll("iframe").forEach((e=>{e.style.width="100%",e.style.height="100%",e.style.display="block"})),function(e,t){const n=e.querySelectorAll("img");if(t){const i=t.getBoundingClientRect();e.style.height=i.height+"px",e.style.maxHeight=i.height+"px",e.style.minHeight=i.height+"px",e.style.width="100%",n.forEach((e=>{e.style.height="100%",e.style.maxHeight="100%",e.style.minHeight="100%"}))}else e.style.height="100%",e.style.maxHeight="100%",e.style.minHeight="100%",e.style.width="100%",n.forEach((e=>{e.style.height="100%",e.style.maxHeight="100%",e.style.minHeight="100%"}))}(r,d)}let l=[],r=0,s=[],o=Math.floor(1e3*Math.random()),a=null;async function d(){let e;try{const t=await fetch("https://verinice.github.io/adsend/env.txt");if(!t.ok)throw new Error("Could not load env.txt file");const n=(await t.text()).match(/^CONFIG_URL\s*=\s*(.+)$/m);if(!n)throw new Error("CONFIG_URL not found in env.txt file");e=n[1].trim(),window.CONFIG_URL=e}catch(e){throw new Error("[AdSend] CONFIG_URL is required in env.txt file: "+e.message)}const t=await fetch(e);if(!t.ok)return;const n=await t.json(),i=Array.isArray(n)?n.find((e=>e.property_id===c)):null;if(!i)return;window._adConfigBanners=i.banners||[];const d=window.location.origin+window.location.pathname;i.url&&!d.startsWith(i.url)||(s=Array.isArray(i.containers)?i.containers:[],s.length&&"object"==typeof s[0]&&s[0].name&&(s=s.map((e=>e.name)).filter(Boolean)),l=(i.banners||[]).map((e=>e.imageUrl&&e.targetUrl?`<a href="${e.targetUrl}" target="_blank" rel="noopener noreferrer"><img src="${e.imageUrl}" alt="ad" class="ad-img-anim" style="max-width:100%;height:auto;display:block;" /></a>`:e.imageUrl?`<img src="${e.imageUrl}" alt="ad" class="ad-img-anim" style="max-width:100%;height:auto;display:block;" />`:"")).filter(Boolean),a=i.copySiblingSelector||null,r=0,o=Math.floor(1e3*Math.random()))}function h(){if(!l.length)return;if(!s.length)return void console.error("[ad-injector] No container selectors found for this page. Please define at least one container/selector.");let t=[];if(s.forEach((e=>{t=t.concat(Array.from(document.querySelectorAll(e)))})),!t.length)return;e([...t]).forEach((e=>{i(l,e)}))}const c=document.currentScript.getAttribute("data-property");c&&async function(){if(await d(),!s.length)return void console.error("[AdSend] No container selectors found for this page. Please define at least one container/selector in ad-config.json.");let t=[];s.forEach((e=>{const n=Array.from(document.querySelectorAll(e));t=t.concat(n)})),l.length&&t.length&&(t=e(t),t.forEach((e=>{i(l,e)}))),l.length>1&&(setInterval(h,1e4),setInterval(d,3e5))}()}();